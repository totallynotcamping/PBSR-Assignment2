---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

## Problem 2 : Simulation Study to Understand Sampling Distribution

**Part A**
Suppose $X_1,X_2,\cdots,X_n\stackrel{iid}{\sim} Gamma(\alpha,\sigma)$, with pdf as
$$
f(x | \alpha,\sigma)=\frac{1}{\sigma^{\alpha}\Gamma(\alpha)}e^{- x/\sigma}x^{\alpha-1},~~~~0<x<\infty,
$$
The mean and variance are $E(X)=\alpha\sigma$ and $Var(X)=\alpha\sigma^2$. note that `shape = ` $\alpha$ and `scale = ` $\sigma$.

1. Write a `function` in `R` which will compute the MLE of $\theta=\log(\alpha)$ using `optim` function in `R`. You can name it `MyMLE`
```{r}
My_MLE <- function(x){
  gamma_1 <- function(m){
     gamma_mx(m,x)
  }
  z <- optim(par=c(1,1),gamma_1)
  log(z$par[1])
}

```


2. Choose `n=20`, and `alpha=1.5` and `sigma=2.2`
     (i) Simulate $\{X_1,X_2,\cdots,X_n\}$ from `rgamma(n=20,shape=1.5,scale=2.2)`
     (ii) Apply the `MyMLE` to estimate $\theta$ and append the value in a vector
     (iii) Repeat the step (i) and (ii) 1000 times
     (iv) Draw histogram of the estimated MLEs of $\theta$.
     (v) Draw a vertical line using `abline` function at the true value of $\theta$.
     (vi) Use `quantile` function on estimated $\theta$'s to find the 2.5 and 97.5-percentile points. 

```{r}
library(stats)
vector = c()
sim_gamma_MLE <- function(n,size,alpha,sigma){
  for (i in 1:size){
    x<-rgamma(n,shape=alpha,scale=sigma)
    gamma_mx <- function(m,x){
      alpha<-m[1]
      sigma<-m[2]
      n*alpha*log(sigma)+n*log(gamma(alpha))-(alpha-1)*sum(log(x))+sum(x)/sigma
    }
    My_MLE <- function(x){
      gamma_1 <- function(m){
        gamma_mx(m,x)
      }
    
    z <- optim(par = c(1,1),gamma_1)
    log(z$par[1])
    }
    vector <- c(vector, My_MLE(x))
  }
  hist(vector)
  abline(v=log(alpha),col='blue')
  cat("following are the percentile for 2.5 an 97.5:")
  quantile(vector,probs=c(0.025,0.975))
}


sim_gamma_MLE(20,1000,1.5,2.2)
```
     
     
3.  Choose `n=40`, and `alpha=1.5` and repeat the (2).
```{r}
sim_gamma_MLE(40,1000,1.5,2.2)
```
4.  Choose `n=100`, and `alpha=1.5` and repeat the (2).

```{r}
sim_gamma_MLE(100,1000,1.5,2.2)
```
5. Check if the gap between 2.5 and 97.5-percentile points are shrinking as sample size `n` is increasing?

yes, the gap gets smaller as the n increases1!


*Hint*: Perhaps you should think of writing a single `function` where you will provide the values of `n`, `sim_size`, `alpha` and `sigma`; and it will return the desired output.